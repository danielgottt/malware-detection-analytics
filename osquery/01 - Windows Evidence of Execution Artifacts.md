## Shimcache
```sql
SELECT DISTINCT path,
CASE WHEN modified_time = 0 
THEN '-' ELSE strftime('%Y-%m-%d %H:%M:%S',datetime(modified_time,'unixepoch')) END AS Modified_Time
FROM shimcache; 
```
## Userassist
```sql
SELECT u.username, ua.sid, strftime('%Y-%m-%dT%H:%M:%SZ',datetime(ua.last_execution_time,'unixepoch')) AS Execution_Time, ua.path, ua.count
FROM userassist ua JOIN users u ON ua.sid = u.uuid;
```
## Shellbags
```sql
SELECT sb.path AS Path, sb.sid AS SID, u.username AS Username, 
strftime('%Y-%m-%dT%H:%M:%SZ',datetime(sb.created_time,'unixepoch')) AS Created_Time,
strftime('%Y-%m-%dT%H:%M:%SZ',datetime(sb.modified_time,'unixepoch')) AS Last_Modified,
strftime('%Y-%m-%dT%H:%M:%SZ',datetime(sb.accessed_time,'unixepoch')) AS Last_Accessed
FROM shellbags sb JOIN users u ON sb.sid = u.uuid
ORDER by sb.accessed_time;
```
## Appcompat
```sql
SELECT SUBSTR(grep.line, 1, INSTR(grep.line, '|') - 1) AS program_fullpath, strftime('%Y-%m-%dT%H:%M:%SZ',SUBSTR(grep.line, INSTR(grep.line, '|') + 1)) AS last_execution_time, hash.sha256, authenticode.subject_name AS certificate_subject_name, f.path, strftime('%Y-%m-%dT%H:%M:%SZ', datetime(f.mtime,'unixepoch')) AS last_modified_time
FROM file f LEFT JOIN grep USING (path) LEFT JOIN hash ON program_fullpath = hash.path LEFT JOIN authenticode ON program_fullpath = authenticode.path
WHERE f.directory = 'C:\Windows\appcompat\pca\' AND f.filename = 'PcaAppLaunchDic.txt';
```
## Prefetch
```sql
SELECT filename, path, STRFTIME('%Y-%m-%d %H:%M:%S', DATETIME(last_run_time, 'unixepoch')) AS last_run_time, replace(other_run_times,',','; ') as other_run_times, run_count, size, replace(accessed_files,',','; ') as accessed_files, replace(accessed_directories,',','; ') as accessed_directories
FROM prefetch;
```

## BAM
```sql
SELECT REGEX_MATCH(bam.path, "[^\\]*$", 0) AS Name, bam.path, strftime('%Y-%m-%dT%H:%M:%SZ',datetime(bam.last_execution_time,'unixepoch')) AS Last_Execution_Time, h.sha256, u.username, bam.sid
FROM background_activities_moderator bam JOIN users u ON bam.sid = u.uuid JOIN hash h ON REPLACE(bam.path,regex_match(bam.path,'(\\Device\\HarddiskVolume.\\)',0),'C:\') = h.path;
```
