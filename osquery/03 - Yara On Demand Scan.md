## On demand yara scan
```sql
WITH signature(yara) AS
(
   SELECT CAST(result AS TEXT) yara
   FROM curl
   WHERE url = '$$URL TO YARA FILE$$'
)

SELECT y.matches, y.path, datetime(file.btime, 'unixepoch') As Creation_time, datetime(file.mtime, 'unixepoch') As Modification_time, h.SHA256
FROM yara y JOIN hash h ON y.path = h.path JOIN file ON y.path = file.path
WHERE sigrule IN (SELECT yara FROM signature) 
AND y.path LIKE '$$FILE_PATH_TO_SCAN$$' 
AND count > 0
```
