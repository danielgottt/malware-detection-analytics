######################################################################################################################

https://www.greynoise.io/blog/watchguard-cve-2022-26318-rce-detection-iocs-and-prevention-for-defenders
https://attackerkb.com/topics/t8Nrnu99ZE/cve-2022-26318
https://har-sia.info/CVE-2022-26318.html
https://github.com/jbaines-r7/watchguard_cve-2022-26318

######################################################################################################################
				
# Hits for the URI, encoding type, and the stream size. (Should try with and without the stream size)

		alert tcp $EXTERNAL_NET any -> $HOME_NET any(msg:"CVE-2022-26318 Observed from External"; \
		stream_size:to_server, >, 600;
		content:"POST"; http_method; \
		content:"/agent/login"; http.uri; \
		content:"Content|2d|Encoding|3a 20|gzip"; \
		priority:2; \
		metadata: Not tested for FP rate or accuracy; \
		reference:url,https://attackerkb.com/topics/t8Nrnu99ZE/cve-2022-26318, CVE-2022-26318; \
		sid:1000005; rev:1;) \

# Hits the people who dont strip the default payload useragent. Not good practice but it do be happenining 

		alert tcp $EXTERNAL_NET any -> $HOME_NET any(msg:"CVE-2022-26318 UA from External"; \
		content:"User-Agent|3A|";
		content:""CVE|2d|2022|2d|26318""; distance:0; fast_pattern;
		priority:2; \
		metadata: Not tested for FP rate or accuracy; \
		reference:url,https://attackerkb.com/topics/t8Nrnu99ZE/cve-2022-26318, CVE-2022-26318; \
		sid:1000006; rev:1;) \

# Way Forward:
