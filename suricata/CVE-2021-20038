
######################################################################################################################

https://attackerkb.com/topics/QyXRC1wbvC/cve-2021-20038/rapid7-analysis
https://www.rapid7.com/blog/post/2022/01/11/cve-2021-20038-42-sonicwall-sma-100-multiple-vulnerabilities-fixed-2/
https://github.com/jbaines-r7/badblood/blob/main/badblood.py

######################################################################################################################

# Hits for the specific count of characters (with some buffer) to trigger the overflow

		alert tcp $EXTERNAL_NET any -> $HOME_NET any(msg:"CVE-2021-20038 Overflow Attempt"; \
		flow:to_server, established; \
		content:"POST"; http_method; \
		content:"|2f 3f|; http.uri; pcre:"/[A-Z]{1793,1799}/"; \
		priority:2; \
		metadata: Not tested for FP rate or accuracy; \
		reference:url,https://www.rapid7.com/blog/post/2022/01/11/cve-2021-20038-42-sonicwall-sma-100-multiple-vulnerabilities-fixed-2/, CVE-2021-20038; \
		sid:1000007; rev:1;) \


# Way Forward
	- This could be pretty loud, and I imagine it does always attribute to the CVE?
