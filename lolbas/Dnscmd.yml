Name: Dnscmd.exe
Description: A command-line interface for managing DNS servers
Author: 'Daniel Gott'
Created: 2022-07-31
Commands:
  - Command: dnscmd.exe 127.0.0.1 /enumrecords fakedomain.local
    Description: Enumerates local DNS resource records on the fakedomain.local domain
    Usecase: Enumerate DNS zones for a particular domain. DNS zones are used to host the DNS records for a particular domain.
    Category: Reconnaissance
    Privileges: Domain Administrator, or SYSTEM
    MitreID: TA0007
    OperatingSystem: Windows server
Command: cmd.exe /Q /c powershell.exe dnscmd.exe 127.0.0.1 /enumrecords fakedomain.local @ 1> \\127.0.0.1\ADMIN$\__1659026954.961697 2>&1
    Description: Successful execution of dnscmd.exe to enumerate the DNS zones of fakedomain.local, then redirect the output to the local interface (Impacket Execution) 
    Usecase: Enumerate DNS zones for a particular domain. DNS zones are used to host the DNS records for a particular domain.
    Category: Reconnaissance
    Privileges: Domain Administrator, or SYSTEM
    MitreID: TA0007
    OperatingSystem: Windows server
Full_Path:
  - Path: C:\Windows\System32\Dnscmd.exe
  - Path: C:\Windows\SysWOW64\Dnscmd.exe
Code_Sample:
  - Code:
Detection:
  - Sigma: tbd
Resources:
  - Link: https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/dnscmd
Acknowledgement:
    - Person: Daniel Gott
      Handle: '@gott_cyber'
