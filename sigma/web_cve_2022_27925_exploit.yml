title: Zimbra collaboration suite email server unauthenticated remote command injection
id: dd218fb6-4d02-42dc-85f0-a0a376072efd
description: Detects an attempt to leverage the vulnerable servlet "mboximport" for an unauthenticated remote command injection
references:
  - https://www.volexity.com/blog/2022/08/10/mass-exploitation-of-unauthenticated-zimbra-rce-cve-2022-27925/
  - https://www.yang99.top/index.php/archives/82/
status: experimental
Author: '@gott_cyber'
date: 2022/08/17
tags:
  - attack.initial_access
  - attack.t1190
  - cve.2022.27925
logsource:
    category: webserver
detection:
    selection1_servlet:
        cs-method: 'POST'
        c-uri|contains: '/service/extension/backup/mboximport?'
    selection1_uri:
        c-uri|contains|all:
            - 'account-name'
            - 'ow'
            - 'no-switch'
            - 'append'
    selection1_status:
        sc-status:
            - '401'
            - '200'
    selection1_noauth:
        - cs-cookie: 'ZM_AUTH_TOKEN'
    selection_shell:
        cs-uri|contains: '/zimbraAdmin/'
        cs-uri|endswith: '.jsp'
        cs-status|contains: '200'
    condition: all of selection1_* or selection_shell
falsepositives:
    - Unknown
level: medium
