title: Windows Enumeration via null sessions
id: dd218fb6-4d02-42dc-85f0-a0a376072efd
description: Detects a SMB session with a blank username and password 
references:
  - https://techcommunity.microsoft.com/t5/storage-at-microsoft/smb-and-null-sessions-why-your-pen-test-is-probably-wrong/ba-p/1185365
  - https://www.7elements.co.uk/resources/guidance/securing-server-message-block-smb-null-session-enumeration/
  - https://sensepost.com/blog/2018/a-new-look-at-null-sessions-and-user-enumeration/
  - https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb_login.rb
status: experimental
Author: '@gott_cyber'
date: 2022/08/18
tags:
  - attack.t1135
  - attack.t1021.002
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        Image|endswith:
            - '\net.exe'
            - '\net1.exe'
        CommandLine|contains:
            - 'use'
            - '\\\\'
            - '\""'
        CommandLine|re: '(\/user\:\""|\/u\:\"")'
    condition: selection
falsepositives:
    - unknown
level: medium
